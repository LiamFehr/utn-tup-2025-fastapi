# ğŸš— TP VENTAS DE AUTOS - API REST

Proyecto realizado con **FastAPI**, **SQLModel** y **PostgreSQL**  
Trabajo PrÃ¡ctico â€“ UTN TUP 2025  
Alumno: *Liam F.*

---

## ğŸ§¾ DescripciÃ³n

API REST para la gestiÃ³n de **autos** y **ventas de autos**.  
Permite realizar **operaciones CRUD completas**, validaciones de datos, y conecta con una base de datos **PostgreSQL** usando ORM con **SQLModel / SQLAlchemy**.

Incluye:

- CRUD completo de Autos y Ventas  
- BÃºsqueda avanzada con filtros  
- Validaciones automÃ¡ticas con FastAPI  
- Regla de negocio: el `total` de una venta debe ser igual a `precio * cantidad`  
- ConexiÃ³n a PostgreSQL configurada desde `database.py`  

---

## âš™ï¸ TecnologÃ­as utilizadas

- ğŸ **Python 3.13**
- âš¡ **FastAPI**
- ğŸ—„ï¸ **SQLModel / SQLAlchemy**
- ğŸ˜ **PostgreSQL**
- ğŸ”Œ **Uvicorn** (servidor ASGI)
- ğŸ§  **Pydantic** (validaciones)
- ğŸ’¾ **psycopg2-binary** (driver PostgreSQL)

---

## ğŸ“ Estructura del proyecto
TP_Ventas_Autos/
â”‚â”€â”€ src/
â”‚ â”œâ”€â”€ main.py # App principal (FastAPI)
â”‚ â”œâ”€â”€ database.py # ConexiÃ³n y sesiÃ³n con PostgreSQL
â”‚ â”œâ”€â”€ models.py # Modelos y validaciones
â”‚ â”œâ”€â”€ autos.py # Endpoints CRUD y filtros para autos
â”‚ â””â”€â”€ ventas.py # Endpoints CRUD con coherencia total en ventas
â”‚
â”œâ”€â”€ venv/ # Entorno virtual
â”œâ”€â”€ requirements.txt # Dependencias (opcional)
â””â”€â”€ README.md # DocumentaciÃ³n del proyecto


---

## ğŸª¬ InstalaciÃ³n y configuraciÃ³n

### 1ï¸âƒ£ Clonar el proyecto
```bash
git clone <url-del-proyecto>
cd TP_Ventas_Autos
2ï¸âƒ£ Crear y activar entorno virtual
bash
Copy
python -m venv venv
venv\Scripts\activate      # En Windows
3ï¸âƒ£ Instalar dependencias
bash
Copy
pip install fastapi uvicorn sqlmodel psycopg2-binary
4ï¸âƒ£ Crear la base de datos en PostgreSQL
Desde pgAdmin o psql ejecutar:

sql
Copy
CREATE DATABASE autosdb;
5ï¸âƒ£ Configurar credenciales
Editar el archivo src/database.py y ajustar con tus valores:

python
Copy
DATABASE_URL = "postgresql+psycopg2://postgres:1234@localhost:5432/autosdb"
(donde 1234 es tu contraseÃ±a)

ğŸš€ Ejecutar el proyecto
bash
Copy
python -m uvicorn src.main:app --reload
ğŸ“ Servidor activo:

http://127.0.0.1:8000
ğŸ“„ DocumentaciÃ³n interactiva (Swagger UI):

http://127.0.0.1:8000/docs
ğŸ§± Endpoints principales
ğŸ”¹ AUTOS
MÃ©todo	Endpoint	DescripciÃ³n
GET	/autos/	Lista todos los autos
GET	/autos/{id}	Obtiene un auto por ID
POST	/autos/	Crea un nuevo auto
PUT	/autos/{id}	Actualiza un auto existente
DELETE	/autos/{id}	Elimina un auto
GET	/autos/buscar	BÃºsqueda filtrada (marca, modelo, aÃ±o, precio)
Ejemplo de cuerpo POST:

json
Copy
{
  "marca": "Toyota",
  "modelo": "Corolla",
  "anio": 2022,
  "precio": 8500000
}
ğŸ”¹ VENTAS
MÃ©todo	Endpoint	DescripciÃ³n
GET	/ventas/	Lista todas las ventas
GET	/ventas/{id}	Obtiene una venta por ID
POST	/ventas/	Crea una nueva venta
PUT	/ventas/{id}	Actualiza una venta existente
DELETE	/ventas/{id}	Elimina una venta
Ejemplo de cuerpo POST:

json
Copy
{
  "fecha": "2025-11-12",
  "cantidad": 2,
  "total": 17000000,
  "auto_id": 1
}
âš ï¸ Si el total no coincide con precio * cantidad, la API devuelve error:

json
Copy
{
  "detail": "Total inconsistente. DeberÃ­a ser 17000000 (= precio*cantidad)"
}
ğŸ§© Validaciones incluidas
Campo	Regla
marca	MÃ­nimo 1, mÃ¡ximo 50 caracteres
modelo	MÃ­nimo 1, mÃ¡ximo 50 caracteres
anio	Mayor a 1900 y menor o igual a 2030
precio	Mayor que 0
cantidad	Mayor que 0
total	Debe coincidir con precio*cantidad
ğŸ§  Regla de negocio
Antes de guardar una venta, la API verifica:

total == (precio_del_auto * cantidad)

Si no se cumple, devuelve un HTTP 400 con mensaje explicativo.

ğŸ§ª Ejemplo de flujo
Crear un auto (POST /autos/)
Crear una venta con ese auto (POST /ventas/)
Consultar las ventas existentes (GET /ventas/)
Eliminar o actualizar los datos segÃºn necesidad
ğŸ–¥ï¸ Acceso a base de datos
Una vez ejecutado, podÃ©s ver las tablas desde pgAdmin â†’ autosdb â†’ Schemas â†’ public â†’ Tables:

auto
venta